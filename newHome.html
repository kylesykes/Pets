<!DOCTYPE html>
<html>

	<!-- jQuery library -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

	<!-- Latest compiled JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.min.css">
      <!-- Compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/js/materialize.min.js"></script>
	
    <body>
        <nav class="nav-extended">
            <div class="nav-wrapper">
            <a href="#" class="brand-logo">Top Dog Information Systems</a>
            <a href="#" data-activates="mobile-demo" class="button-collapse"><i class="material-icons">menu</i></a>
            <ul id="nav-mobile" class="right hide-on-med-and-down">
                <li><a href="make.html">Logout</a></li>
            </ul>
            <ul class="side-nav" id="mobile-demo">
                <li><a href="make.html">Logout</a></li>
            </ul>
            </div>
            <div class="nav-content">
            <ul class="tabs tabs-transparent">
                <li class="tab"><a class="active" href="#test1">Pets</a></li>
                <li id="ownerTab" class="tab"><a href="#test2">Owners</a></li>
            </ul>
            </div>
        </nav>
        <div id="test1" class="col s12">
            <a href="NewPetDetail.html" class="waves-effect waves-light btn-large">Register New Pet</a>
            <h2>Pets</h2>
            <div id="resultsField2" class="collection">
            </div>
        </div>
        <div id="test2" class="col s12">
            <a href="OwnerRegister.html" class="waves-effect waves-light btn-large">Register New Owner</a>
            <h2>Owners</h2>
            <div id="resultsField" class="collection">
            </div>
        </div>
    </body>
</html>

<script>
    var ownerTab = document.getElementById("ownerTab");
    var resultsModal = document.getElementById('searchResults');
    var loadingModal = document.getElementById('loadingIcon');
    var resultsDiv = document.getElementById("resultsField");
    var resultsHeader = document.getElementById("resultsHeader");

    var logoutButton = document.getElementById("logout");


    ownerTab.addEventListener("click", function() {
        console.log("activated");
        var resultsName = "";
        var queryKey = "";
        var pageName = "";

        //loadingModal.style.display="block";
        searchType = "owner" //$('input[name="searchCategory"]:checked').val();

        switch(searchType) {
            case "owner":
                resultsName = "Owners:";
                pageName = "ViewOwner.html";
                queryKey = "?username=";
                break;
            case "pet":
                resultsName = "Pets:";
                pageName = "ViewPet.html";
                queryKey = "?pet_id=";
                break;
            default:
                //loadingModal.style.display="none";
        }

        //resultsHeader.innerHTML = "<h1>"+resultsName+"</h1>";
        
        fetch("https://bwp-python-webapp.herokuapp.com/"+searchType, {
                method:"GET",
            }).then(function(res){
                    res.json().then(function(json){
                        var contents = "";
                        json.forEach(function(element) {
                            var javaCommand = "document.location.href='" + pageName + queryKey + element + "';";
                            contents += "<button onclick=\"" + javaCommand + "\">" + element + "</button>";
                        }, this);
                        console.log(contents);
                        resultsDiv.innerHTML = contents;
                        //loadingModal.style.display="none";
                        //resultsModal.style.display="block";
                    })
                })
    });

    /*searchButton.addEventListener("click", function() {
        var resultsName = "";
        var queryKey = "";
        var pageName = "";

        loadingModal.style.display="block";
        searchType = $('input[name="searchCategory"]:checked').val();

        switch(searchType) {
            case "owner":
                resultsName = "Owners:";
                pageName = "ViewOwner.html";
                queryKey = "?username=";
                break;
            case "pet":
                resultsName = "Pets:";
                pageName = "ViewPet.html";
                queryKey = "?name=";
                break;
            default:
                loadingModal.style.display="none";
        }

        resultsHeader.innerHTML = "<h1>"+resultsName+"</h1>";
        
        fetch("https://bwp-python-webapp.herokuapp.com/"+searchType, {
                method:"GET",
            }).then(function(res){
                    res.json().then(function(json){
                        var contents = "";
                        json.forEach(function(element) {
                            var javaCommand = "document.location.href='" + pageName + queryKey + element + "';";
                            contents += "<button onclick=\"" + javaCommand + "\">" + element + "</button>";
                        }, this);
                        console.log(contents);
                        resultsDiv.innerHTML = contents;
                        loadingModal.style.display="none";
                        resultsModal.style.display="block";
                    })
                })
    });*/
</script>